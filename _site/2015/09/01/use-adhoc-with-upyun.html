<!DOCTYPE html>
<html xmlns="http://www.w3.org/1999/xhtml" xml:lang="en" lang="en-us">
  <head>
    <meta http-equiv="content-type" content="text/html; charset=utf-8" />
    <meta name="author" content="Harry" />
    
    <title>通过upyun解决iOS7.1后使用AdHoc下载的问题</title>
    
    <link rel="shortcut icon" href="/favicon.ico">
    <link href="/atom.xml" rel="alternate" title="red3 harry" type="application/atom+xml" />
    <link rel="stylesheet" href="//cdnjs.cloudflare.com/ajax/libs/font-awesome/4.2.0/css/font-awesome.min.css">
    <link rel="stylesheet" href="/media/css/style.css">
    <script type="text/javascript" src="//cdnjs.cloudflare.com/ajax/libs/retina.js/1.3.0/retina.min.js"></script>
    <link rel="stylesheet" href="//cdnjs.cloudflare.com/ajax/libs/highlight.js/8.4/styles/github.min.css">
    <script src="//cdnjs.cloudflare.com/ajax/libs/highlight.js/8.4/highlight.min.js"></script>
    <script type="text/javascript"> hljs.initHighlightingOnLoad(); </script>
  </head>
  <body>
      <div id="main" role="main">
        <header>
          <div id="header">
            <h1><a title="red3 harry" class="" href="/">red3 harry</a></h1>
          </div>
          <nav>
            
            <span><a title="Archive" href="/archive.html"><i class="fa fa-list-ul"></i></a></span>
            
            <span><a title="Tags" href="/tags.html"><i class="fa fa-tags"></i></a></span>
            
            <span><a title="About" href="/about.html"><i class="fa fa-user"></i></a></span>
            
            <span><a title="Gallery" href="http://redthree.lofter.com"><i class="fa fa-film"></i></a></span>
            
            <span><a title="Subscribe" href="/atom.xml"><i class="fa fa-rss"></i></a></span>
            
          </nav>
        </header>
        <div id="content">
        <article>
  <section class="title">
    <h2>通过upyun解决iOS7.1后使用AdHoc下载的问题 </h2>
  </section>
  <section class="meta">
  <span class="time">
    <time datetime="2015-09-01">2015-09-01</time>
  </span>
  
  <span class="tags">
    
  </span>
  <!-- BEGIN this would not work on any other domain -->
  <span
    class           = "like-wrapper"
    like-shortname  = 'gopherwood'
    like-identifier = ''
    like-name       = '通过upyun解决iOS7.1后使用AdHoc下载的问题'
    like-btn        = '&#xf087;'
    like-link       = '/2015/09/01/use-adhoc-with-upyun.html'
    ></span>
  <script type="text/javascript">
    var l = document.createElement('script');
    l.type = 'text/javascript'; l.async = true; l.src = 'http://www.like-btn.com/javascript/widget.js';
    (document.getElementsByTagName('head')[0] || document.getElementsByTagName('body')[0]).appendChild(l);
  </script>
  <!-- END this would not work on any other domain -->
  
  </section>
  <section class="post">
  <h2 id="section">前言</h2>

<p>相信大家都已经知道，在苹果发布iOS7.1后，AdHoc不能够接受未经ssl验证的mainfest了，也就是说plist文件的路径需要从http转换为https了。</p>

<pre><code>itms-services://?action=download-manifest&amp;url=http://yourdomain.com/app.plist
==&gt; //更换为
itms-services://?action=download-manifest&amp;url=https://yourdomain.com/app.plist
</code></pre>

<p>应对这个改变，我们有两种方法可以采取：</p>

<ul>
  <li>在本地局域网搭建ssl环境。之前的博客<a href="">Mac OS X 中为Apache开启ssl</a>就是为了应对这个改变做得一些尝试，但是无奈在本地局域网中配置证书太过麻烦，最终放弃。想要尝试该方法的童鞋可以参考<a href="http://blog.cnbluebox.com/blog/2014/03/25/ios7-dot-1xia-shi-yong-adhocfang-fa-xia-zai-de-jie-jue-fang-an/">这篇博客</a></li>
  <li>采用https外链。很高兴了解到<a href="">upyun</a>今天（2015.9.1）宣布全面免费，并且upyun是支持做https外链的。所以今天主要尝试通过upyun做一个支持ssl的外链。</li>
</ul>

<p>仔细想想，是不是今后博客中的图片都可以放在upyun做CDN加速了，吼吼。</p>

<h2 id="section-1">准备工作</h2>

<p>注册upyun成功后会提示必须绑定支付宝做实名认证，否则无法享受全部功能，吓得我赶紧连接支付宝做了实名认证，没有做实验不实名认证的话，是否支持https外链功能。</p>

<p>添加一个<code>存储类</code>空间，并为这个空间开启https访问功能，如下图：</p>

<p><img src="http://redharry.b0.upaiyun.com/pic/upyun_with_ssl.gif" alt="" /></p>

<p>哈哈，其实这么简单地步骤完全没有必要上图，我只是单纯想测试下Mac上录制gif图片（我用的是<a href="http://www.recordit.co/">Recordit</a>这个软件）以及测试下upyun的CDN图片加速。</p>

<h2 id="section-2">上传文件</h2>

<p>上传文件需要先创建一个<code>操作员</code>。在<code>账号管理</code>菜单下选择<code>操作员管理</code>来新建一个操作员，并在<code>通用</code>菜单中选择<code>操作员管理授权</code>将刚才新建的操作员授权于管理空间权限。</p>

<p>假设现在我们有一个名为<code>bucket</code>的空间，并且为这个空间授权了一个名为<code>user</code>的操作员。那么：</p>

<ol>
  <li>
    <p>关于FTP的配置</p>

    <ul>
      <li>主机：v1.ftp.upyun.com (电信) v2.ftp.upyun.com (联通网通) v3.ftp.upyun.com (移动铁通) v0.ftp.upyun.com (自动判断</li>
      <li>用户：操作员的用户名/空间名（对应我们的空间应该是<code>user/bucket</code>）</li>
      <li>密码：操作员的密码</li>
      <li>端口：21</li>
      <li>文件传输协议：FTP</li>
    </ul>
  </li>
  <li>
    <p>关于外链的配置</p>

    <ul>
      <li>默认域名：bucket.b0.upaiyun.com （bucket是空间名）</li>
      <li>文件访问方式：http://默认域名/文件路径
（例如：文件路径/dir/pic.jpg 该图片对外访问地址为：http://bucket.b0.upaiyun.com/dir/pic.jpg）</li>
      <li>ssl方式只需将http替换为https</li>
      <li>如果绑定了自己的域名，只需将默认域名替换为自己的域名就可以了</li>
    </ul>
  </li>
</ol>

<p>如果是使用客户端的话，推荐使用<a href="">FileZilla</a>这个软件，不要再提Finder的远程连接服务器了，功能弱爆了。</p>

<p>成功登陆后的软件界面大概是这个样子：</p>

<p><img src="http://redharry.b0.upaiyun.com/pic/how_does_filezilla_looks_like.png" alt="" /></p>

<p>可以直接把文件拖到红框圈住的地方实现文件的上传。</p>

<p>如果非要使用终端的话，下面是终端的操作：</p>

<pre><code>// 以`user/bucket`这个用户登录ftp服务器
ftp user/bucket@v1.ftp.upyun.com
// 然后输入密码
// 登录成功
// 查看所有可用命令
？
// 上传本地文件
put Info.plist /plist/abc.plist //将本地的工作目录下地Info.plist 上传至服务器/plist/abc.plist这个路径，plist这个文件夹如不存在，会自动创建
// 下载远程文件
get /plist/abc.plist abc.plist //将远程服务器/plist/abc.plist 拷贝到本地工作目录下
</code></pre>

<p>至此，就可以通过<code>https://bucket.b0.upaiyun.com/plist/abc.plist</code>这个外链来访问plist文件了。</p>


  </section>
  
</article>

        </div>
        <footer>
          <div>
            
            &copy; 2015 ~ 2015 Harry | powered by jekyll | themed by <a href="http://lhzhang.com" title="sext vi">sext vi</a> | fork <a href="https://github.com/red3" title="fork me">me</a>
          </div>
        </footer>
      </div> <!-- main -->
  </body>
</html>
