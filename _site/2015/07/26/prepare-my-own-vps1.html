<!DOCTYPE html>
<html xmlns="http://www.w3.org/1999/xhtml" xml:lang="en" lang="en-us">
  <head>
    <meta http-equiv="content-type" content="text/html; charset=utf-8" />
    <meta name="author" content="Harry" />
    
    <title>折腾自己的服务器系列（一）之配置服务器</title>
    
    <link rel="shortcut icon" href="/favicon.ico">
    <link href="/atom.xml" rel="alternate" title="red3 harry" type="application/atom+xml" />
    <link rel="stylesheet" href="//cdnjs.cloudflare.com/ajax/libs/font-awesome/4.2.0/css/font-awesome.min.css">
    <link rel="stylesheet" href="/media/css/style.css">
    <script type="text/javascript" src="//cdnjs.cloudflare.com/ajax/libs/retina.js/1.3.0/retina.min.js"></script>
    <link rel="stylesheet" href="//cdnjs.cloudflare.com/ajax/libs/highlight.js/8.4/styles/github.min.css">
    <script src="//cdnjs.cloudflare.com/ajax/libs/highlight.js/8.4/highlight.min.js"></script>
    <script type="text/javascript"> hljs.initHighlightingOnLoad(); </script>
  </head>
  <body>
      <div id="main" role="main">
        <header>
          <div id="header">
            <h1><a title="red3 harry" class="" href="/">red3 harry</a></h1>
          </div>
          <nav>
            
            <span><a title="Archive" href="/archive.html"><i class="fa fa-list-ul"></i></a></span>
            
            <span><a title="Tags" href="/tags.html"><i class="fa fa-tags"></i></a></span>
            
            <span><a title="About" href="/about.html"><i class="fa fa-user"></i></a></span>
            
            <span><a title="Gallery" href="http://redthree.lofter.com"><i class="fa fa-film"></i></a></span>
            
            <span><a title="Subscribe" href="/atom.xml"><i class="fa fa-rss"></i></a></span>
            
          </nav>
        </header>
        <div id="content">
        <article>
  <section class="title">
    <h2>折腾自己的服务器系列（一）之配置服务器 </h2>
  </section>
  <section class="meta">
  <span class="time">
    <time datetime="2015-07-26">2015-07-26</time>
  </span>
  
  <span class="tags">
    
    <a href="/tags.html#Linux" title="Linux">#Linux</a>
    
  </span>
  <!-- BEGIN this would not work on any other domain -->
  <span
    class           = "like-wrapper"
    like-shortname  = 'gopherwood'
    like-identifier = ''
    like-name       = '折腾自己的服务器系列（一）之配置服务器'
    like-btn        = '&#xf087;'
    like-link       = '/2015/07/26/prepare-my-own-vps1.html'
    ></span>
  <script type="text/javascript">
    var l = document.createElement('script');
    l.type = 'text/javascript'; l.async = true; l.src = 'http://www.like-btn.com/javascript/widget.js';
    (document.getElementsByTagName('head')[0] || document.getElementsByTagName('body')[0]).appendChild(l);
  </script>
  <!-- END this would not work on any other domain -->
  
  </section>
  <section class="post">
  <p>生命不息，折腾不止。为了消灭自己的懒惰情绪，增强匮乏感，也正值阿里云服务器打折，遂买了个服务器折腾一下。在这个过程中所遇到的所有问题、难点等均可在网路上找到相关资料，之所以还再写这个系列，一是记录下这个过程，方便以后查询；二是因为网路中很多资料都已过时，故整理出最新可用的资料供需要的人查询。</p>

<p>So，这个系列大概要做这些事情：</p>

<ul>
  <li>配置服务器：包括Apache，PHP，MYSQL，FTP，PhpMyAdmin等</li>
  <li>配置域名：将自己的域名指向服务器，以及设置二级域名等。</li>
</ul>

<p>今天这个系列主要就是记录写如何配置刚购买的服务器。
这里需要说明的是，以下的操作都是基于CentOS6.4版本。</p>

<h2 id="section">安装基本的软件服务</h2>
<p>首先通过远程登录，连接到服务器，因为我用的是Mac，所以直接用ssh命令登录：</p>

<pre><code>ssh ip地址 -l root 
</code></pre>

<p>CentOS下推荐适用yum安装软件，故通过下列命令安装我们所需的服务：</p>

<pre><code>// 安装Apache服务
yum install -y httpd
// 安装PHP
yum install -y php
// 安装MYSQL
yum install -y mysql-server mysql
// 安装sftp
yum install -y vsftpd 
</code></pre>

<p>至此，基本的服务都已安装，不得不感叹Linux作为服务器来说，确实比MAC和Windows有优势，安装太方便了。接下来的就是配置下这些服务，让他们运行起来。</p>

<h2 id="apache">配置Apache</h2>
<p>我们需要修改两个地方，修改配置文件以及在网站根目录创建index.html.</p>

<pre><code>// 下面这个目录是配置文件所在目录
vi /etc/httpd/conf/httpd.conf 找到 `#ServerName www.example.com:80`将注释关闭，变成类似这样的`ServerName 服务器的公网ip:80`。

// 下面这个目录是Apache默认的网站目录
cd /var/www/html
touch index.html
</code></pre>

<p>创建<code>index.html</code>后，往里面随便写点东西。
现在在本地浏览器中访问服务器的公网ip，应该就可以看到刚才我们在<code>index.html</code>中输入的内容了。
需要注意的是阿里云服务器默认是开放<strong>80</strong>端口的，通过这个命令<code>service iptables status</code>查看当前防火墙状态:</p>

<pre><code>service iptables status
表格：filter
Chain INPUT (policy ACCEPT)
num  target    prot opt source            destination         
1    ACCEPT    tcp  --  0.0.0.0/0         0.0.0.0/0    tcp dpt:22 
2    ACCEPT    tcp  --  0.0.0.0/0         0.0.0.0/0    tcp dpt:80
</code></pre>

<p>可以看到当前服务器已经开放了<strong>80</strong>端口和<strong>22</strong>端口。
如果服务器默认没有开放<strong>80</strong>端口，还需要开放<strong>80</strong>端口，可以这样：</p>

<pre><code>// 开放80端口 
iptables -A INPUT -p tcp -m tcp --dport 80 -j ACCEPT
// 因为要使用sftp，顺便也开放22端口
iptables -A INPUT -p tcp -m tcp --dport 22 -j ACCEPT
// 保存
service iptables save
</code></pre>

<p>至此，Apache的设置就完成了。</p>

<h2 id="sftp">配置SFTP</h2>
<p>默认的，和Apache一样，sftp的配置文件在这个目录<code>/etc//vsftpd/</code>下。sftp默认是不允许root用户登录的，因为是我自己的服务器，并不需要别人参与开发，所以就简单的设置下如何配置root用户可以登录（需要说明的是开启root用户会很不安全，因为root用户的权限太大）：</p>

<pre><code>// ftpusers中的用户是黑名单用户是不允许从sftp登录的 
vi /etc/vsftpd/ftpusers // 把列表中的root注释
// sftp默认开启userlist_deny，会阻止user_list中的用户
vi /etc/vsftpd/user_list //  把列表中的root注释
</code></pre>

<p>现在尝试在客户端通过sftp连接服务器吧。对于Mac电脑，推荐这个软件<a href="https://filezilla-project.org/download.php?type=client">Filezilla</a>，或者给Sublime装个插件，都可以连上服务器了。</p>

<h2 id="mysql">配置MySQL</h2>
<p>之前的这个步骤<code>yum install -y mysql-server mysql</code>已经安装了MySQL所需的软件服务。要运行MySQL服务，需要这些命令：</p>

<pre><code>// 启动mysqld服务 要关闭的话将start替换成stop
service mysqld start
// 给root用户设置密码为ab123 默认刚安装的数据库是没有密码的，所以需要先设置密码
mysqladmin -uroot -password ab123
// 连接数据库
mysql -uroot -p
// 提示输入密码后，就可进入mysql命令模式了
// 推出mysql命令模式
// exit
</code></pre>

<p>关于数据库的管理，还是推荐使用phpMyAdmin更加方便些。关于phpmyadmin，可以选择yum安装，也可以直接从<a href="http://www.phpmyadmin.net/downloads/">官网</a>下载。
今天的系列就先到这了，下一系列说说配置域名的事情。</p>


  </section>
  
</article>

        </div>
        <footer>
          <div>
            
            &copy; 2015 ~ 2015 Harry | powered by jekyll | themed by <a href="http://lhzhang.com" title="sext vi">sext vi</a> | fork <a href="https://github.com/red3" title="fork me">me</a>
          </div>
        </footer>
      </div> <!-- main -->
  </body>
</html>
